{"ast":null,"code":"import { createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createCommentVNode as _createCommentVNode, vModelText as _vModelText, withDirectives as _withDirectives, withModifiers as _withModifiers, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-96f3dc52\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"container\"\n};\nconst _hoisted_2 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"h1\", {\n  class: \"text-center\"\n}, \"This is ChatSync!\", -1 /* HOISTED */));\nconst _hoisted_3 = {\n  class: \"row\"\n};\nconst _hoisted_4 = {\n  class: \"col-sm-6 offset-3\"\n};\nconst _hoisted_5 = {\n  key: 0,\n  id: \"chat-container\",\n  class: \"card\"\n};\nconst _hoisted_6 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"card-header text-white text-center font-weight-bold subtle-blue-gradient\"\n}, \" Share the page URL to invite new friends \", -1 /* HOISTED */));\nconst _hoisted_7 = {\n  class: \"card-body\"\n};\nconst _hoisted_8 = {\n  class: \"container chat-body\"\n};\nconst _hoisted_9 = {\n  class: \"col-sm-7 offset-3\"\n};\nconst _hoisted_10 = {\n  class: \"card-text speech-bubble speech-bubble-user float-end text-white subtle-blue-gradient\"\n};\nconst _hoisted_11 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"col-sm-2\"\n}, [/*#__PURE__*/_createElementVNode(\"img\", {\n  class: \"rounded-circle\",\n  src: \"https://mrwallpaper.com/images/hd/cute-girl-vector-art-profile-picture-jhbu3wt713zj2bti.jpg\"\n})], -1 /* HOISTED */));\nconst _hoisted_12 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"col-sm-2\"\n}, [/*#__PURE__*/_createElementVNode(\"img\", {\n  class: \"rounded-circle\",\n  src: \"https://img.freepik.com/free-vector/isolated-young-handsome-man-different-poses-white-background-illustration_632498-859.jpg?size=338&ext=jpg&ga=GA1.1.1224184972.1711929600&semt=ais\"\n})], -1 /* HOISTED */));\nconst _hoisted_13 = {\n  class: \"col-sm-7\"\n};\nconst _hoisted_14 = {\n  class: \"card-text speech-bubble speech-bubble-peer float-start\"\n};\nconst _hoisted_15 = {\n  class: \"card-footer text-muted\"\n};\nconst _hoisted_16 = {\n  class: \"row\"\n};\nconst _hoisted_17 = {\n  class: \"col-sm-10\"\n};\nconst _hoisted_18 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"col-sm-2\"\n}, [/*#__PURE__*/_createElementVNode(\"button\", {\n  class: \"btn btn-primary\"\n}, \"Send\")], -1 /* HOISTED */));\nconst _hoisted_19 = {\n  key: 1\n};\nconst _hoisted_20 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"h3\", {\n  class: \"text-center\"\n}, \"Welcome!\", -1 /* HOISTED */));\nconst _hoisted_21 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"br\", null, null, -1 /* HOISTED */));\nconst _hoisted_22 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"p\", {\n  class: \"text-center\"\n}, \"To start chatting with friends click on the button below, it will start a new chat session and then you can invite your friends over to chat!\", -1 /* HOISTED */));\nconst _hoisted_23 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"br\", null, null, -1 /* HOISTED */));\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_hoisted_2, _createElementVNode(\"div\", _hoisted_3, [_createElementVNode(\"div\", _hoisted_4, [$data.sessionStarted ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [_hoisted_6, _createElementVNode(\"div\", _hoisted_7, [_createElementVNode(\"div\", _hoisted_8, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.messages, message => {\n    return _openBlock(), _createElementBlock(\"div\", {\n      key: message.id,\n      class: \"row chat-section\"\n    }, [_ctx.username === message.user.username ? (_openBlock(), _createElementBlock(_Fragment, {\n      key: 0\n    }, [_createElementVNode(\"div\", _hoisted_9, [_createElementVNode(\"span\", _hoisted_10, _toDisplayString(message.message), 1 /* TEXT */)]), _hoisted_11], 64 /* STABLE_FRAGMENT */)) : (_openBlock(), _createElementBlock(_Fragment, {\n      key: 1\n    }, [_hoisted_12, _createElementVNode(\"div\", _hoisted_13, [_createElementVNode(\"span\", _hoisted_14, _toDisplayString(message.message), 1 /* TEXT */)])], 64 /* STABLE_FRAGMENT */))]);\n  }), 128 /* KEYED_FRAGMENT */))])]), _createElementVNode(\"div\", _hoisted_15, [_createElementVNode(\"form\", {\n    onSubmit: _cache[1] || (_cache[1] = _withModifiers((...args) => $options.postMessage && $options.postMessage(...args), [\"prevent\"]))\n  }, [_createElementVNode(\"div\", _hoisted_16, [_createElementVNode(\"div\", _hoisted_17, [_withDirectives(_createElementVNode(\"input\", {\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $data.message = $event),\n    type: \"text\",\n    placeholder: \"Type a message\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.message]])]), _hoisted_18])], 32 /* NEED_HYDRATION */)])])) : (_openBlock(), _createElementBlock(\"div\", _hoisted_19, [_hoisted_20, _hoisted_21, _hoisted_22, _hoisted_23, _createElementVNode(\"button\", {\n    onClick: _cache[2] || (_cache[2] = (...args) => $options.startChatSession && $options.startChatSession(...args)),\n    class: \"btn btn-primary btn-lg btn-block\"\n  }, \"Start Chatting\")]))])])]);\n}","map":{"version":3,"names":["class","_createElementVNode","key","id","src","_createElementBlock","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","$data","sessionStarted","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_Fragment","_renderList","messages","message","_ctx","username","user","_hoisted_9","_hoisted_10","_toDisplayString","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","onSubmit","_cache","_withModifiers","args","$options","postMessage","_hoisted_16","_hoisted_17","$event","type","placeholder","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","_hoisted_22","_hoisted_23","onClick","startChatSession"],"sources":["/Users/siowyy/Documents/Projects/chatsync/chatsync-frontend/src/views/ChatView.vue"],"sourcesContent":["<template>\n    <div class=\"container\">\n        <h1 class=\"text-center\">This is ChatSync!</h1>\n        <div class=\"row\">\n            <div class=\"col-sm-6 offset-3\">\n                <div v-if=\"sessionStarted\" id=\"chat-container\" class=\"card\">\n                    <div class=\"card-header text-white text-center font-weight-bold subtle-blue-gradient\">\n                        Share the page URL to invite new friends\n                    </div>\n                    <div class=\"card-body\">\n                        <div class=\"container chat-body\">\n                            <div v-for=\"message in messages\" :key=\"message.id\" class=\"row chat-section\">\n                                <template v-if=\"username === message.user.username\">\n                                    <div class=\"col-sm-7 offset-3\">\n                                        <span class=\"card-text speech-bubble speech-bubble-user float-end text-white subtle-blue-gradient\">{{ message.message }}</span>\n                                    </div>\n                                    <div class=\"col-sm-2\">\n                                        <img class=\"rounded-circle\" src=\"https://mrwallpaper.com/images/hd/cute-girl-vector-art-profile-picture-jhbu3wt713zj2bti.jpg\">\n                                    </div>\n                                </template>\n                                <template v-else>\n                                    <div class=\"col-sm-2\">\n                                        <img class=\"rounded-circle\" src=\"https://img.freepik.com/free-vector/isolated-young-handsome-man-different-poses-white-background-illustration_632498-859.jpg?size=338&ext=jpg&ga=GA1.1.1224184972.1711929600&semt=ais\">\n                                    </div>\n                                    <div class=\"col-sm-7\">\n                                        <span class=\"card-text speech-bubble speech-bubble-peer float-start\">{{ message.message }}</span>\n                                    </div>\n                                </template>\n                            </div>\n                        </div>\n                    </div>\n                    <div class=\"card-footer text-muted\">\n                        <form @submit.prevent=\"postMessage\">\n                            <div class=\"row\">\n                                <div class=\"col-sm-10\">\n                                    <input v-model=\"message\" type=\"text\" placeholder=\"Type a message\">\n                                </div>\n                                <div class=\"col-sm-2\">\n                                    <button class=\"btn btn-primary\">Send</button>\n                                </div>\n                             </div>\n                        </form>\n                    </div>\n                </div>\n                <div v-else>\n                    <h3 class=\"text-center\">Welcome!</h3>\n                    <br>\n                    <p class=\"text-center\">To start chatting with friends click on the button below, it will start a new chat session and then you can invite your friends over to chat!</p>\n                    <br>\n                    <button @click=\"startChatSession\" class=\"btn btn-primary btn-lg btn-block\">Start Chatting</button>\n                </div>\n            </div>\n        </div>\n    </div>\n</template>\n\n<script>\nconst $ = window.jQuery\nexport default {\n  data () {\n    return {\n      sessionStarted: false,\n      messages: [],\n      message: ''\n    }\n  },\n  created () {\n    this.username = sessionStorage.getItem('username')\n    $.ajaxSetup({\n      //beforeSend: function (xhr) {\n        //xhr.setRequestHeader('Authorization', `JWT ${sessionStorage.getItem('authToken')}`)\n      headers: {\n        'Authorization': `Token ${sessionStorage.getItem('authToken')}`\n        }\n      })\n      if (this.$route.params.uri) {\n        this.joinChatSession()\n      }\n    setInterval(this.fetchChatSessionHistory, 3000)\n  },\n  methods: {\n    startChatSession () {\n      $.post('http://localhost:8000/api/chats/', (data) => {\n        alert(\"A new session has been created you'll be redirected automatically\")\n        this.sessionStarted = true\n        this.$router.push(`/chats/${data.uri}/`)\n      })\n        .fail((response) => {\n          alert(response.responseText)\n        })\n    },\n    postMessage (event) {\n      const data = { message: this.message }\n      $.post(`http://localhost:8000/api/chats/${this.$route.params.uri}/messages/`, data, (data) => {\n        this.message = ''\n      })\n        .fail((response) => {\n          alert(response.responseText)\n        })\n    },\n    joinChatSession () {\n      const uri = this.$route.params.uri\n      $.ajax({\n        url: `http://localhost:8000/api/chats/${uri}/`,\n        data: { username: this.username },\n        type: 'PATCH',\n        success: (data) => {\n          const user = data.members.find((member) => member.username === this.username)\n          if (user) {\n            this.sessionStarted = true\n            this.fetchChatSessionHistory()\n          }\n        }\n      })\n    },\n    fetchChatSessionHistory () {\n      $.get(`http://127.0.0.1:8000/api/chats/${this.$route.params.uri}/messages/`, (data) => {\n        this.messages = data.messages\n      })\n    }\n  }\n}\n</script>\n\n<style scoped>\n    h1, h2 {\n        font-weight: normal;\n    }\n    img {\n        height: 40px;\n        width: 40px;\n    }\n    ul {\n        list-style-type: none;\n        padding: 0;\n    }\n    li {\n        display: inline-block;\n        margin: 0 10px;\n    }\n    .button {\n        border-radius: 0;\n    }\n    .card-footer input[type=\"text\"] {\n        background-color: #ffffff;\n        color: #444444;\n        padding: 7px;\n        font-size: 13px;\n        border: 2px solid #cccccc;\n        width: 100%;\n        height: 38px;\n    }\n    .card-header a {\n        text-decoration: underline;\n    }\n    .card-body {\n        background-color: #dddddd;\n    }\n    .chat-body {\n        margin-top: -15px;\n        margin-bottom: -5px;\n        height: 380px;\n        overflow-y: auto;\n    }\n    .speech-bubble {\n        display: inline-block;\n        position: relative;\n        border-radius: 0.4em;\n        padding: 10px;\n        background-color: #fff;\n        font-size: 14px;\n    }\n    .subtle-blue-gradient {\n        background: linear-gradient(45deg,#004bff, #007bff);\n    }\n    .speech-bubble-user:after {\n        content: \"\";\n        position: absolute;\n        right: 4px;\n        top: 10px;\n        width: 0;\n        height: 0;\n        border: 20px solid transparent;\n        border-left-color: #007bff;\n        border-right: 0;\n        border-top: 0;\n        margin-top: -10px;\n        margin-right: -20px;\n    }\n    .speech-bubble-peer:after {\n        content: \"\";\n        position: absolute;\n        left: 3px;\n        top: 10px;\n        width: 0;\n        height: 0;\n        border: 20px solid transparent;\n        border-right-color: #ffffff;\n        border-top: 0;\n        border-left: 0;\n        margin-top: -10px;\n        margin-left: -20px;\n    }\n    .chat-section:first-child {\n        margin-top: 10px;\n    }\n    .chat-section {\n        margin-top: 15px;\n    }\n    .send-section {\n        margin-bottom: -20px;\n        padding-bottom: 10px;\n    }\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}